// ğŸ““ SYED'S FINAL EXPRESS + TYPESCRIPT + TSX SETUP NOTES

// âœ… 1. Init Project
npm init -y
tsc --init

// âœ… 2. Install Dependencies
npm i express config mongoose nodemailer twilio bcrypt jsonwebtokem
npm i -D typescript tsx @types/node @types/express @types/config @types/mongoose @types/bcrypt @types/jsonwebtoken @types/nodemailer @types/twilio 

// âœ… 3. tsconfig.json Setup
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "moduleResolution": "bundler", // âœ… TS 5.9+ safe
    "rootDir": "./src",
    "outDir": "./dist",
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "strict": true,
    "skipLibCheck": true,
    "types": ["node"],
    "verbatimModuleSyntax": false,
    "allowImportingTsExtensions": true // âœ… Optional: silences .ts import warning
  },
  "include": ["src"]
}

// âœ… 4. package.json Scripts
"type": "module",
"main": "dist/app.js",
"scripts": {
  "dev": "tsx src/app.ts",         
  "build": "tsc",                  
  "start": "node dist/app.js"
}

// âœ… 5. Folder Structure
server/
â”œâ”€â”€ config/           âœ… config.get() reads from here
â”‚   â””â”€â”€ default.json  â†’ { "PORT": 7075 }
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.ts        âœ… main entry
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ dbConnect.ts
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ todos.ts

// âœ… 6. app.ts Sample
import express, { Application, Request, Response } from "express";
import config from "config";
import "./utils/dbConnect.ts"; // âœ… keep .ts if using tsx

const app: Application = express();
const PORT: number = config.get<number>("PORT");

app.use(express.json());

app.get("/", (req: Request, res: Response): void => {
  res.status(200).json({ msg: "ğŸ”¥ Express + TypeScript server is running!" });
});

app.listen(PORT, (): void => {
  console.log(`ğŸš€ Server started on http://localhost:${PORT}`);
});

// âœ… 7. Dev Flow
npm run dev   // tsx runs .ts directly, no build needed
npm run build // optional: compiles to dist/
npm run start // runs compiled JS

// âœ… 8. Common Mistakes to Avoid
// âŒ Wrong import path or casing â†’ Linux is case-sensitive
// âŒ Forgetting .ts in import â†’ breaks in tsx unless allowed
// âŒ Keeping config inside src/ â†’ config.get() fails
// âŒ Using nodemon + ts-node/esm â†’ deprecated, buggy
// âŒ Missing "type": "module" â†’ import/export breaks

// ğŸ”¥ You're now running a clean, typed, scalable Express server with tsx-powered dev flow and zero import drama.